<section id="messages-manage">

<div class="panel-group" id="accordion-message">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion-message" href="#collapse-current-messages">
          Nachrichten editieren <span class="badge"><?php echo e(count($messages)); ?></span>
        </a>
      </h4>
    </div>
    <div id="collapse-current-messages" class="panel-collapse collapse <?php if( Session::has('success') ): ?> in <?php endif; ?>">
      <div class="panel-body">
        <div id="current-messages">
        <?php foreach($messages as $message): ?>
          <div class ="message">
            <div class="alert alert-<?php echo e($message->type); ?>" role="alert">
              <?php echo e(Session::reflash()); ?>

              <?php /* DELETE FORM */ ?>
              <?php echo Form::open(['id' => 'message-delete-'. $message->id, 'url' => 'api/v1/messages/' . $message->id, 'method' => 'DELETE', 'role' => 'form']); ?>


                <?php echo Form::button('<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>', ['type' => 'button', 'class' => 'close']); ?>


              <?php echo Form::close(); ?>



              <?php /* UPDATE MESSAGE */ ?>
              <?php echo Form::open(['id' => 'message-update-'. $message->id, 'url' => 'api/v1/messages/' . $message->id, 'method' => 'PATCH', 'role' => 'form']); ?>


                <?php echo Form::label('message-content-'. $message->id, 'Messages', ['class' => 'hidden']); ?>

                <?php echo Form::textarea('message'. $message->id, $message->message, ['id' => 'message-content-'. $message->id, 'rows' => '3', 'maxlength' => '300', 'class' => 'form-control message-update-content']); ?>


                <?php echo Form::label('message-type-'. $message->id, 'Messages', ['class' => 'hidden']); ?>

                <?php echo Form::select('type', ['info' =>'Information', 'warning' => 'Warnung', 'danger' => 'Wichtig'], $message->type, ['id' => 'message-type-'. $message->id, 'class' => 'message-update-type']); ?>


                <?php /* Automatisches Senden beim VerÃ¤ndern des Inhalts (vgl. Notes) */ ?>

              <?php echo Form::close(); ?>


            </div>
            <div class="ajax-info-<?php echo e($message->id); ?> progress">
              <div class="progress-bar progress-bar-success"  role="progressbar" style="width: 100%;"></div>
              <?php /* @todo  Auch Screenreder-Info aktualisieren. */ ?>
              <span class="sr-only">Aktualisiert</span>
            </div>
          </div>
        <?php endforeach; ?>
        </div>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion-message" href="#collapse-new-message">
          Neue Nachrichten erstellen
        </a>
      </h4>
    </div>
    <div id="collapse-new-message" class="panel-collapse collapse">
      <div class="panel-body">
        <div id="new-message">
          <div class="alert alert-info" role="alert">

            <?php /* STORE FORM */ ?>
            <?php echo Form::open(['id' => 'message-store', 'url' => 'api/v1/messages','role' => 'form']); ?>


              <?php echo Form::label('message-new-content', 'Messages', ['class' => 'hidden']); ?>

              <?php echo Form::textarea('message', '', ['rows' => '3', 'maxlength' => '300', 'class' => 'form-control', 'placeholder' => 'Geben Sie eine neue Nachricht ein.', 'id' => 'message-new-content', 'required']); ?>


              <?php echo Form::label('message-type', 'Messages', ['class' => 'hidden']); ?>

              <?php echo Form::select('type', ['info' =>'Information', 'warning' => 'Warnung', 'danger' => 'Wichtig']); ?>


              <?php echo Form::submit('Erstellen'); ?>


            <?php echo Form::close(); ?>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</section>
